!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("pixi.js")):"function"==typeof define&&define.amd?define(["exports","pixi.js"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).PixiGraph={},t.PIXI)}(this,(function(t,e){"use strict";function i(t){if(t&&t.__esModule)return t;var e=Object.create(null);return t&&Object.keys(t).forEach((function(i){if("default"!==i){var s=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:function(){return t[i]}})}})),e.default=t,Object.freeze(e)}var s,n=i(e);function o(e,i,s){var o;if(e===t.TextType.TEXT)o=new n.Text(i,{fontFamily:s.fontFamily,fontSize:s.fontSize,fill:16777215});else{if(e!==t.TextType.BITMAP_TEXT)throw new Error("Invalid state");o=new n.BitmapText(i,{fontName:s.fontFamily,fontSize:s.fontSize})}return o.roundPixels=!0,o}
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */t.TextType=void 0,(s=t.TextType||(t.TextType={})).TEXT="TEXT",s.BITMAP_TEXT="BITMAP_TEXT";var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)};function h(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}class a{constructor(t){this.viewport=t,this.touches=[],this.addListeners()}addListeners(){this.viewport.interactive=!0,this.viewport.forceHitArea||(this.viewport.hitArea=new e.Rectangle(0,0,this.viewport.worldWidth,this.viewport.worldHeight)),this.viewport.on("pointerdown",this.down,this),this.viewport.on("pointermove",this.move,this),this.viewport.on("pointerup",this.up,this),this.viewport.on("pointerupoutside",this.up,this),this.viewport.on("pointercancel",this.up,this),this.viewport.on("pointerout",this.up,this),this.wheelFunction=t=>this.handleWheel(t),this.viewport.options.divWheel.addEventListener("wheel",this.wheelFunction,{passive:this.viewport.options.passiveWheel}),this.isMouseDown=!1}destroy(){this.viewport.options.divWheel.removeEventListener("wheel",this.wheelFunction)}down(t){if(this.viewport.pause||!this.viewport.worldVisible)return;if("mouse"===t.data.pointerType?this.isMouseDown=!0:this.get(t.data.pointerId)||this.touches.push({id:t.data.pointerId,last:null}),1===this.count()){this.last=t.data.global.clone();const e=this.viewport.plugins.get("decelerate",!0),i=this.viewport.plugins.get("bounce",!0);e&&e.isActive()||i&&i.isActive()?this.clickedAvailable=!1:this.clickedAvailable=!0}else this.clickedAvailable=!1;this.viewport.plugins.down(t)&&this.viewport.options.stopPropagation&&t.stopPropagation()}clear(){this.isMouseDown=!1,this.touches=[],this.last=null}checkThreshold(t){return Math.abs(t)>=this.viewport.threshold}move(t){if(this.viewport.pause||!this.viewport.worldVisible)return;const e=this.viewport.plugins.move(t);if(this.clickedAvailable){const e=t.data.global.x-this.last.x,i=t.data.global.y-this.last.y;(this.checkThreshold(e)||this.checkThreshold(i))&&(this.clickedAvailable=!1)}e&&this.viewport.options.stopPropagation&&t.stopPropagation()}up(t){if(this.viewport.pause||!this.viewport.worldVisible)return;"mouse"===t.data.pointerType&&(this.isMouseDown=!1),"mouse"!==t.data.pointerType&&this.remove(t.data.pointerId);const e=this.viewport.plugins.up(t);this.clickedAvailable&&0===this.count()&&(this.viewport.emit("clicked",{event:t,screen:this.last,world:this.viewport.toWorld(this.last),viewport:this}),this.clickedAvailable=!1),e&&this.viewport.options.stopPropagation&&t.stopPropagation()}getPointerPosition(t){let i=new e.Point;return this.viewport.options.interaction?this.viewport.options.interaction.mapPositionToPoint(i,t.clientX,t.clientY):(i.x=t.clientX,i.y=t.clientY),i}handleWheel(t){if(this.viewport.pause||!this.viewport.worldVisible)return;if(this.viewport.options.interaction&&this.viewport.options.interaction.interactionDOMElement!==t.target)return;const e=this.viewport.toLocal(this.getPointerPosition(t));if(this.viewport.left<=e.x&&e.x<=this.viewport.right&&this.viewport.top<=e.y&&e.y<=this.viewport.bottom){this.viewport.plugins.wheel(t)&&!this.viewport.options.passiveWheel&&t.preventDefault()}}pause(){this.touches=[],this.isMouseDown=!1}get(t){for(let e of this.touches)if(e.id===t)return e;return null}remove(t){for(let e=0;e<this.touches.length;e++)if(this.touches[e].id===t)return void this.touches.splice(e,1)}count(){return(this.isMouseDown?1:0)+this.touches.length}}const p=["drag","pinch","wheel","follow","mouse-edges","decelerate","aniamte","bounce","snap-zoom","clamp-zoom","snap","clamp"];class l{constructor(t){this.viewport=t,this.list=[],this.plugins={}}add(t,e,i=p.length){this.plugins[t]=e;const s=p.indexOf(t);-1!==s&&p.splice(s,1),p.splice(i,0,t),this.sort()}get(t,e){return e&&this.plugins[t]&&this.plugins[t].paused?null:this.plugins[t]}update(t){for(let e of this.list)e.update(t)}resize(){for(let t of this.list)t.resize()}reset(){for(let t of this.list)t.reset()}removeAll(){this.plugins={},this.sort()}remove(t){this.plugins[t]&&(delete this.plugins[t],this.viewport.emit(t+"-remove"),this.sort())}pause(t){this.plugins[t]&&this.plugins[t].pause()}resume(t){this.plugins[t]&&this.plugins[t].resume()}sort(){this.list=[];for(let t of p)this.plugins[t]&&this.list.push(this.plugins[t])}down(t){let e=!1;for(let i of this.list)i.down(t)&&(e=!0);return e}move(t){let e=!1;for(let i of this.viewport.plugins.list)i.move(t)&&(e=!0);return e}up(t){let e=!1;for(let i of this.list)i.up(t)&&(e=!0);return e}wheel(t){let e=!1;for(let i of this.list)i.wheel(t)&&(e=!0);return e}}class d{constructor(t){this.parent=t,this.paused=!1}destroy(){}down(){return!1}move(){return!1}up(){return!1}wheel(){return!1}update(){}resize(){}reset(){}pause(){this.paused=!0}resume(){this.paused=!1}}const c={direction:"all",pressDrag:!0,wheel:!0,wheelScroll:1,reverse:!1,clampWheel:!1,underflow:"center",factor:1,mouseButtons:"all",keyToPress:null,ignoreKeyToPressOnTouch:!1,lineHeight:20};class u extends d{constructor(t,e={}){super(t),this.options=Object.assign({},c,e),this.moved=!1,this.reverse=this.options.reverse?1:-1,this.xDirection=!this.options.direction||"all"===this.options.direction||"x"===this.options.direction,this.yDirection=!this.options.direction||"all"===this.options.direction||"y"===this.options.direction,this.keyIsPressed=!1,this.parseUnderflow(),this.mouseButtons(this.options.mouseButtons),this.options.keyToPress&&this.handleKeyPresses(this.options.keyToPress)}handleKeyPresses(t){window.addEventListener("keydown",(e=>{t.includes(e.code)&&(this.keyIsPressed=!0)})),window.addEventListener("keyup",(e=>{t.includes(e.code)&&(this.keyIsPressed=!1)}))}mouseButtons(t){this.mouse=t&&"all"!==t?[-1!==t.indexOf("left"),-1!==t.indexOf("middle"),-1!==t.indexOf("right")]:[!0,!0,!0]}parseUnderflow(){const t=this.options.underflow.toLowerCase();"center"===t?(this.underflowX=0,this.underflowY=0):(this.underflowX=-1!==t.indexOf("left")?-1:-1!==t.indexOf("right")?1:0,this.underflowY=-1!==t.indexOf("top")?-1:-1!==t.indexOf("bottom")?1:0)}checkButtons(t){const e="mouse"===t.data.pointerType,i=this.parent.input.count();return!(!(1===i||i>1&&!this.parent.plugins.get("pinch",!0))||e&&!this.mouse[t.data.button])}checkKeyPress(t){return!!(!this.options.keyToPress||this.keyIsPressed||this.options.ignoreKeyToPressOnTouch&&"touch"===t.data.pointerType)}down(t){if(!this.paused&&this.options.pressDrag)return this.checkButtons(t)&&this.checkKeyPress(t)?(this.last={x:t.data.global.x,y:t.data.global.y},this.current=t.data.pointerId,!0):void(this.last=null)}get active(){return this.moved}move(t){if(!this.paused&&this.options.pressDrag&&this.last&&this.current===t.data.pointerId){const i=t.data.global.x,s=t.data.global.y,n=this.parent.input.count();if(1===n||n>1&&!this.parent.plugins.get("pinch",!0)){const n=i-this.last.x,o=s-this.last.y;if(this.moved||this.xDirection&&this.parent.input.checkThreshold(n)||this.yDirection&&this.parent.input.checkThreshold(o)){const n={x:i,y:s};return this.xDirection&&(this.parent.x+=(n.x-this.last.x)*this.options.factor),this.yDirection&&(this.parent.y+=(n.y-this.last.y)*this.options.factor),this.last=n,this.moved||this.parent.emit("drag-start",{event:t,screen:new e.Point(this.last.x,this.last.y),world:this.parent.toWorld(new e.Point(this.last.x,this.last.y)),viewport:this.parent}),this.moved=!0,this.parent.emit("moved",{viewport:this.parent,type:"drag"}),!0}}else this.moved=!1}}up(t){if(this.paused)return;const i=this.parent.input.touches;if(1===i.length){const t=i[0];return t.last&&(this.last={x:t.last.x,y:t.last.y},this.current=t.id),this.moved=!1,!0}if(this.last&&this.moved){const i=new e.Point(this.last.x,this.last.y);return this.parent.emit("drag-end",{event:t,screen:i,world:this.parent.toWorld(i),viewport:this.parent}),this.last=null,this.moved=!1,!0}}wheel(t){if(!this.paused&&this.options.wheel){if(!this.parent.plugins.get("wheel",!0)){const e=t.deltaMode?this.options.lineHeight:1;return this.xDirection&&(this.parent.x+=t.deltaX*e*this.options.wheelScroll*this.reverse),this.yDirection&&(this.parent.y+=t.deltaY*e*this.options.wheelScroll*this.reverse),this.options.clampWheel&&this.clamp(),this.parent.emit("wheel-scroll",this.parent),this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.options.passiveWheel||t.preventDefault(),!0}}}resume(){this.last=null,this.paused=!1}clamp(){const t=this.parent.plugins.get("decelerate",!0)||{};if("y"!==this.options.clampWheel)if(this.parent.screenWorldWidth<this.parent.screenWidth)switch(this.underflowX){case-1:this.parent.x=0;break;case 1:this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/2}else this.parent.left<0?(this.parent.x=0,t.x=0):this.parent.right>this.parent.worldWidth&&(this.parent.x=-this.parent.worldWidth*this.parent.scale.x+this.parent.screenWidth,t.x=0);if("x"!==this.options.clampWheel)if(this.parent.screenWorldHeight<this.parent.screenHeight)switch(this.underflowY){case-1:this.parent.y=0;break;case 1:this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2}else this.parent.top<0&&(this.parent.y=0,t.y=0),this.parent.bottom>this.parent.worldHeight&&(this.parent.y=-this.parent.worldHeight*this.parent.scale.y+this.parent.screenHeight,t.y=0)}}const f={noDrag:!1,percent:1,center:null,factor:1,axis:"all"};class g extends d{constructor(t,e={}){super(t),this.options=Object.assign({},f,e)}down(){if(this.parent.input.count()>=2)return this.active=!0,!0}isAxisX(){return["all","x"].includes(this.options.axis)}isAxisY(){return["all","y"].includes(this.options.axis)}move(t){if(this.paused||!this.active)return;const e=t.data.global.x,i=t.data.global.y,s=this.parent.input.touches;if(s.length>=2){const n=s[0],o=s[1],r=n.last&&o.last?Math.sqrt(Math.pow(o.last.x-n.last.x,2)+Math.pow(o.last.y-n.last.y,2)):null;if(n.id===t.data.pointerId?n.last={x:e,y:i,data:t.data}:o.id===t.data.pointerId&&(o.last={x:e,y:i,data:t.data}),r){let t;const e={x:n.last.x+(o.last.x-n.last.x)/2,y:n.last.y+(o.last.y-n.last.y)/2};this.options.center||(t=this.parent.toLocal(e));let i=Math.sqrt(Math.pow(o.last.x-n.last.x,2)+Math.pow(o.last.y-n.last.y,2));i=0===i?i=1e-10:i;const s=(1-r/i)*this.options.percent*(this.isAxisX()?this.parent.scale.x:this.parent.scale.y);this.isAxisX()&&(this.parent.scale.x+=s),this.isAxisY()&&(this.parent.scale.y+=s),this.parent.emit("zoomed",{viewport:this.parent,type:"pinch",center:e});const h=this.parent.plugins.get("clamp-zoom",!0);if(h&&h.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const i=this.parent.toGlobal(t);this.parent.x+=(e.x-i.x)*this.options.factor,this.parent.y+=(e.y-i.y)*this.options.factor,this.parent.emit("moved",{viewport:this.parent,type:"pinch"})}!this.options.noDrag&&this.lastCenter&&(this.parent.x+=(e.x-this.lastCenter.x)*this.options.factor,this.parent.y+=(e.y-this.lastCenter.y)*this.options.factor,this.parent.emit("moved",{viewport:this.parent,type:"pinch"})),this.lastCenter=e,this.moved=!0}else this.pinching||(this.parent.emit("pinch-start",this.parent),this.pinching=!0);return!0}}up(){if(this.pinching&&this.parent.input.touches.length<=1)return this.active=!1,this.lastCenter=null,this.pinching=!1,this.moved=!1,this.parent.emit("pinch-end",this.parent),!0}}const y={left:!1,right:!1,top:!1,bottom:!1,direction:null,underflow:"center"};class m extends d{constructor(t,e={}){super(t),this.options=Object.assign({},y,e),this.options.direction&&(this.options.left="x"===this.options.direction||"all"===this.options.direction||null,this.options.right="x"===this.options.direction||"all"===this.options.direction||null,this.options.top="y"===this.options.direction||"all"===this.options.direction||null,this.options.bottom="y"===this.options.direction||"all"===this.options.direction||null),this.parseUnderflow(),this.last={x:null,y:null,scaleX:null,scaleY:null},this.update()}parseUnderflow(){const t=this.options.underflow.toLowerCase();"none"===t?this.noUnderflow=!0:"center"===t?(this.underflowX=this.underflowY=0,this.noUnderflow=!1):(this.underflowX=-1!==t.indexOf("left")?-1:-1!==t.indexOf("right")?1:0,this.underflowY=-1!==t.indexOf("top")?-1:-1!==t.indexOf("bottom")?1:0,this.noUnderflow=!1)}move(){return this.update(),!1}update(){if(this.paused)return;if(this.parent.x===this.last.x&&this.parent.y===this.last.y&&this.parent.scale.x===this.last.scaleX&&this.parent.scale.y===this.last.scaleY)return;const t={x:this.parent.x,y:this.parent.y},e=this.parent.plugins.decelerate||{};if(null!==this.options.left||null!==this.options.right){let i=!1;if(!this.noUnderflow&&this.parent.screenWorldWidth<this.parent.screenWidth)switch(this.underflowX){case-1:0!==this.parent.x&&(this.parent.x=0,i=!0);break;case 1:this.parent.x!==this.parent.screenWidth-this.parent.screenWorldWidth&&(this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth,i=!0);break;default:this.parent.x!==(this.parent.screenWidth-this.parent.screenWorldWidth)/2&&(this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/2,i=!0)}else null!==this.options.left&&this.parent.left<(!0===this.options.left?0:this.options.left)&&(this.parent.x=-(!0===this.options.left?0:this.options.left)*this.parent.scale.x,e.x=0,i=!0),null!==this.options.right&&this.parent.right>(!0===this.options.right?this.parent.worldWidth:this.options.right)&&(this.parent.x=-(!0===this.options.right?this.parent.worldWidth:this.options.right)*this.parent.scale.x+this.parent.screenWidth,e.x=0,i=!0);i&&this.parent.emit("moved",{viewport:this.parent,original:t,type:"clamp-x"})}if(null!==this.options.top||null!==this.options.bottom){let i=!1;if(!this.noUnderflow&&this.parent.screenWorldHeight<this.parent.screenHeight)switch(this.underflowY){case-1:0!==this.parent.y&&(this.parent.y=0,i=!0);break;case 1:this.parent.y!==this.parent.screenHeight-this.parent.screenWorldHeight&&(this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight,i=!0);break;default:this.parent.y!==(this.parent.screenHeight-this.parent.screenWorldHeight)/2&&(this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2,i=!0)}else null!==this.options.top&&this.parent.top<(!0===this.options.top?0:this.options.top)&&(this.parent.y=-(!0===this.options.top?0:this.options.top)*this.parent.scale.y,e.y=0,i=!0),null!==this.options.bottom&&this.parent.bottom>(!0===this.options.bottom?this.parent.worldHeight:this.options.bottom)&&(this.parent.y=-(!0===this.options.bottom?this.parent.worldHeight:this.options.bottom)*this.parent.scale.y+this.parent.screenHeight,e.y=0,i=!0);i&&this.parent.emit("moved",{viewport:this.parent,original:t,type:"clamp-y"})}this.last.x=this.parent.x,this.last.y=this.parent.y,this.last.scaleX=this.parent.scale.x,this.last.scaleY=this.parent.scale.y}reset(){this.update()}}const v={minWidth:null,minHeight:null,maxWidth:null,maxHeight:null,minScale:null,maxScale:null};class w extends d{constructor(t,e={}){super(t),this.options=Object.assign({},v,e),this.clamp()}resize(){this.clamp()}clamp(){if(!this.paused)if(this.options.minWidth||this.options.minHeight||this.options.maxWidth||this.options.maxHeight){let t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight;if(null!==this.options.minWidth&&t<this.options.minWidth){const i=this.parent.scale.x;this.parent.fitWidth(this.options.minWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/i,t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(null!==this.options.maxWidth&&t>this.options.maxWidth){const i=this.parent.scale.x;this.parent.fitWidth(this.options.maxWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/i,t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(null!==this.options.minHeight&&e<this.options.minHeight){const i=this.parent.scale.y;this.parent.fitHeight(this.options.minHeight,!1,!1,!0),this.parent.scale.x*=this.parent.scale.y/i,t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(null!==this.options.maxHeight&&e>this.options.maxHeight){const t=this.parent.scale.y;this.parent.fitHeight(this.options.maxHeight,!1,!1,!0),this.parent.scale.x*=this.parent.scale.y/t,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}}else{let t=this.parent.scale.x;null!==this.options.minScale&&t<this.options.minScale&&(t=this.options.minScale),null!==this.options.maxScale&&t>this.options.maxScale&&(t=this.options.maxScale),t!==this.parent.scale.x&&(this.parent.scale.set(t),this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"}))}}reset(){this.clamp()}}const x={friction:.98,bounce:.8,minSpeed:.01},b=16;class M extends d{constructor(t,e={}){super(t),this.options=Object.assign({},x,e),this.saved=[],this.timeSinceRelease=0,this.reset(),this.parent.on("moved",(t=>this.moved(t)))}destroy(){this.parent}down(){this.saved=[],this.x=this.y=!1}isActive(){return this.x||this.y}move(){if(this.paused)return;const t=this.parent.input.count();(1===t||t>1&&!this.parent.plugins.get("pinch",!0))&&(this.saved.push({x:this.parent.x,y:this.parent.y,time:performance.now()}),this.saved.length>60&&this.saved.splice(0,30))}moved(t){if(this.saved.length){const e=this.saved[this.saved.length-1];"clamp-x"===t.type?e.x===t.original.x&&(e.x=this.parent.x):"clamp-y"===t.type&&e.y===t.original.y&&(e.y=this.parent.y)}}up(){if(0===this.parent.input.count()&&this.saved.length){const t=performance.now();for(let e of this.saved)if(e.time>=t-100){const i=t-e.time;this.x=(this.parent.x-e.x)/i,this.y=(this.parent.y-e.y)/i,this.percentChangeX=this.percentChangeY=this.options.friction,this.timeSinceRelease=0;break}}}activate(t){void 0!==(t=t||{}).x&&(this.x=t.x,this.percentChangeX=this.options.friction),void 0!==t.y&&(this.y=t.y,this.percentChangeY=this.options.friction)}update(t){if(this.paused)return;const e=this.x||this.y,i=this.timeSinceRelease,s=this.timeSinceRelease+t;if(this.x){const t=this.percentChangeX,e=Math.log(t);this.parent.x+=this.x*b/e*(Math.pow(t,s/b)-Math.pow(t,i/b))}if(this.y){const t=this.percentChangeY,e=Math.log(t);this.parent.y+=this.y*b/e*(Math.pow(t,s/b)-Math.pow(t,i/b))}this.timeSinceRelease+=t,this.x*=Math.pow(this.percentChangeX,t/b),this.y*=Math.pow(this.percentChangeY,t/b),Math.abs(this.x)<this.options.minSpeed&&(this.x=0),Math.abs(this.y)<this.options.minSpeed&&(this.y=0),e&&this.parent.emit("moved",{viewport:this.parent,type:"decelerate"})}reset(){this.x=this.y=null}}var C="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var E=function(t){var e={exports:{}};return t(e,e.exports),e.exports}((function(t,e){(function(){var e;(function(e){t.exports=e})(e={linear:function(t,e,i,s){return i*t/s+e},easeInQuad:function(t,e,i,s){return i*(t/=s)*t+e},easeOutQuad:function(t,e,i,s){return-i*(t/=s)*(t-2)+e},easeInOutQuad:function(t,e,i,s){return(t/=s/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,i,s){return i*(t/=s)*t*t+e},easeOutCubic:function(t,e,i,s){return i*((t=t/s-1)*t*t+1)+e},easeInOutCubic:function(t,e,i,s){return(t/=s/2)<1?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e},easeInQuart:function(t,e,i,s){return i*(t/=s)*t*t*t+e},easeOutQuart:function(t,e,i,s){return-i*((t=t/s-1)*t*t*t-1)+e},easeInOutQuart:function(t,e,i,s){return(t/=s/2)<1?i/2*t*t*t*t+e:-i/2*((t-=2)*t*t*t-2)+e},easeInQuint:function(t,e,i,s){return i*(t/=s)*t*t*t*t+e},easeOutQuint:function(t,e,i,s){return i*((t=t/s-1)*t*t*t*t+1)+e},easeInOutQuint:function(t,e,i,s){return(t/=s/2)<1?i/2*t*t*t*t*t+e:i/2*((t-=2)*t*t*t*t+2)+e},easeInSine:function(t,e,i,s){return-i*Math.cos(t/s*(Math.PI/2))+i+e},easeOutSine:function(t,e,i,s){return i*Math.sin(t/s*(Math.PI/2))+e},easeInOutSine:function(t,e,i,s){return-i/2*(Math.cos(Math.PI*t/s)-1)+e},easeInExpo:function(t,e,i,s){return 0===t?e:i*Math.pow(2,10*(t/s-1))+e},easeOutExpo:function(t,e,i,s){return t===s?e+i:i*(1-Math.pow(2,-10*t/s))+e},easeInOutExpo:function(t,e,i,s){return(t/=s/2)<1?i/2*Math.pow(2,10*(t-1))+e:i/2*(2-Math.pow(2,-10*--t))+e},easeInCirc:function(t,e,i,s){return-i*(Math.sqrt(1-(t/=s)*t)-1)+e},easeOutCirc:function(t,e,i,s){return i*Math.sqrt(1-(t=t/s-1)*t)+e},easeInOutCirc:function(t,e,i,s){return(t/=s/2)<1?-i/2*(Math.sqrt(1-t*t)-1)+e:i/2*(Math.sqrt(1-(t-=2)*t)+1)+e},easeInElastic:function(t,e,i,s){var n,o,r;return r=1.70158,0===t||(t/=s),(o=0)||(o=.3*s),(n=i)<Math.abs(i)?(n=i,r=o/4):r=o/(2*Math.PI)*Math.asin(i/n),-n*Math.pow(2,10*(t-=1))*Math.sin((t*s-r)*(2*Math.PI)/o)+e},easeOutElastic:function(t,e,i,s){var n,o,r;return r=1.70158,0===t||(t/=s),(o=0)||(o=.3*s),(n=i)<Math.abs(i)?(n=i,r=o/4):r=o/(2*Math.PI)*Math.asin(i/n),n*Math.pow(2,-10*t)*Math.sin((t*s-r)*(2*Math.PI)/o)+i+e},easeInOutElastic:function(t,e,i,s){var n,o,r;return r=1.70158,0===t||(t/=s/2),(o=0)||(o=s*(.3*1.5)),(n=i)<Math.abs(i)?(n=i,r=o/4):r=o/(2*Math.PI)*Math.asin(i/n),t<1?n*Math.pow(2,10*(t-=1))*Math.sin((t*s-r)*(2*Math.PI)/o)*-.5+e:n*Math.pow(2,-10*(t-=1))*Math.sin((t*s-r)*(2*Math.PI)/o)*.5+i+e},easeInBack:function(t,e,i,s,n){return void 0===n&&(n=1.70158),i*(t/=s)*t*((n+1)*t-n)+e},easeOutBack:function(t,e,i,s,n){return void 0===n&&(n=1.70158),i*((t=t/s-1)*t*((n+1)*t+n)+1)+e},easeInOutBack:function(t,e,i,s,n){return void 0===n&&(n=1.70158),(t/=s/2)<1?i/2*(t*t*((1+(n*=1.525))*t-n))+e:i/2*((t-=2)*t*((1+(n*=1.525))*t+n)+2)+e},easeInBounce:function(t,i,s,n){return s-e.easeOutBounce(n-t,0,s,n)+i},easeOutBounce:function(t,e,i,s){return(t/=s)<1/2.75?i*(7.5625*t*t)+e:t<2/2.75?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e},easeInOutBounce:function(t,i,s,n){return t<n/2?.5*e.easeInBounce(2*t,0,s,n)+i:.5*e.easeOutBounce(2*t-n,0,s,n)+.5*s+i}})}).call(C)}));function L(t,e){return t?"function"==typeof t?t:"string"==typeof t?E[t]:void 0:E[e]}const O={sides:"all",friction:.5,time:150,ease:"easeInOutSine",underflow:"center",bounceBox:null};class W extends d{constructor(t,e={}){super(t),this.options=Object.assign({},O,e),this.ease=L(this.options.ease,"easeInOutSine"),this.options.sides&&("all"===this.options.sides?this.top=this.bottom=this.left=this.right=!0:"horizontal"===this.options.sides?this.right=this.left=!0:"vertical"===this.options.sides?this.top=this.bottom=!0:(this.top=-1!==this.options.sides.indexOf("top"),this.bottom=-1!==this.options.sides.indexOf("bottom"),this.left=-1!==this.options.sides.indexOf("left"),this.right=-1!==this.options.sides.indexOf("right"))),this.parseUnderflow(),this.last={},this.reset()}parseUnderflow(){const t=this.options.underflow.toLowerCase();"center"===t?(this.underflowX=0,this.underflowY=0):(this.underflowX=-1!==t.indexOf("left")?-1:-1!==t.indexOf("right")?1:0,this.underflowY=-1!==t.indexOf("top")?-1:-1!==t.indexOf("bottom")?1:0)}isActive(){return null!==this.toX||null!==this.toY}down(){this.toX=this.toY=null}up(){this.bounce()}update(t){if(!this.paused){if(this.bounce(),this.toX){const e=this.toX;e.time+=t,this.parent.emit("moved",{viewport:this.parent,type:"bounce-x"}),e.time>=this.options.time?(this.parent.x=e.end,this.toX=null,this.parent.emit("bounce-x-end",this.parent)):this.parent.x=this.ease(e.time,e.start,e.delta,this.options.time)}if(this.toY){const e=this.toY;e.time+=t,this.parent.emit("moved",{viewport:this.parent,type:"bounce-y"}),e.time>=this.options.time?(this.parent.y=e.end,this.toY=null,this.parent.emit("bounce-y-end",this.parent)):this.parent.y=this.ease(e.time,e.start,e.delta,this.options.time)}}}calcUnderflowX(){let t;switch(this.underflowX){case-1:t=0;break;case 1:t=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:t=(this.parent.screenWidth-this.parent.screenWorldWidth)/2}return t}calcUnderflowY(){let t;switch(this.underflowY){case-1:t=0;break;case 1:t=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:t=(this.parent.screenHeight-this.parent.screenWorldHeight)/2}return t}oob(){const t=this.options.bounceBox;if(t){const i=void 0===t.x?0:t.x,s=void 0===t.y?0:t.y,n=void 0===t.width?this.parent.worldWidth:t.width,o=void 0===t.height?this.parent.worldHeight:t.height;return{left:this.parent.left<i,right:this.parent.right>n,top:this.parent.top<s,bottom:this.parent.bottom>o,topLeft:new e.Point(i*this.parent.scale.x,s*this.parent.scale.y),bottomRight:new e.Point(n*this.parent.scale.x-this.parent.screenWidth,o*this.parent.scale.y-this.parent.screenHeight)}}return{left:this.parent.left<0,right:this.parent.right>this.parent.worldWidth,top:this.parent.top<0,bottom:this.parent.bottom>this.parent.worldHeight,topLeft:new e.Point(0,0),bottomRight:new e.Point(this.parent.worldWidth*this.parent.scale.x-this.parent.screenWidth,this.parent.worldHeight*this.parent.scale.y-this.parent.screenHeight)}}bounce(){if(this.paused)return;let t,e=this.parent.plugins.get("decelerate",!0);e&&(e.x||e.y)&&(e.x&&e.percentChangeX===e.options.friction||e.y&&e.percentChangeY===e.options.friction)&&(t=this.oob(),(t.left&&this.left||t.right&&this.right)&&(e.percentChangeX=this.options.friction),(t.top&&this.top||t.bottom&&this.bottom)&&(e.percentChangeY=this.options.friction));const i=this.parent.plugins.get("drag",!0)||{},s=this.parent.plugins.get("pinch",!0)||{};if(e=e||{},!(i.active||s.active||this.toX&&this.toY||e.x&&e.y)){t=t||this.oob();const i=t.topLeft,s=t.bottomRight;if(!this.toX&&!e.x){let e=null;t.left&&this.left?e=this.parent.screenWorldWidth<this.parent.screenWidth?this.calcUnderflowX():-i.x:t.right&&this.right&&(e=this.parent.screenWorldWidth<this.parent.screenWidth?this.calcUnderflowX():-s.x),null!==e&&this.parent.x!==e&&(this.toX={time:0,start:this.parent.x,delta:e-this.parent.x,end:e},this.parent.emit("bounce-x-start",this.parent))}if(!this.toY&&!e.y){let e=null;t.top&&this.top?e=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-i.y:t.bottom&&this.bottom&&(e=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-s.y),null!==e&&this.parent.y!==e&&(this.toY={time:0,start:this.parent.y,delta:e-this.parent.y,end:e},this.parent.emit("bounce-y-start",this.parent))}}}reset(){this.toX=this.toY=null,this.bounce()}}const _={topLeft:!1,friction:.8,time:1e3,ease:"easeInOutSine",interrupt:!0,removeOnComplete:!1,removeOnInterrupt:!1,forceStart:!1};class S extends d{constructor(t,e,i,s={}){super(t),this.options=Object.assign({},_,s),this.ease=L(s.ease,"easeInOutSine"),this.x=e,this.y=i,this.options.forceStart&&this.snapStart()}snapStart(){this.percent=0,this.snapping={time:0};const t=this.options.topLeft?this.parent.corner:this.parent.center;this.deltaX=this.x-t.x,this.deltaY=this.y-t.y,this.startX=t.x,this.startY=t.y,this.parent.emit("snap-start",this.parent)}wheel(){this.options.removeOnInterrupt&&this.parent.plugins.remove("snap")}down(){this.options.removeOnInterrupt?this.parent.plugins.remove("snap"):this.options.interrupt&&(this.snapping=null)}up(){if(0===this.parent.input.count()){const t=this.parent.plugins.get("decelerate",!0);t&&(t.x||t.y)&&(t.percentChangeX=t.percentChangeY=this.options.friction)}}update(t){if(!(this.paused||this.options.interrupt&&0!==this.parent.input.count()))if(this.snapping){const e=this.snapping;let i,s,n;if(e.time+=t,e.time>this.options.time)i=!0,s=this.startX+this.deltaX,n=this.startY+this.deltaY;else{const t=this.ease(e.time,0,1,this.options.time);s=this.startX+this.deltaX*t,n=this.startY+this.deltaY*t}this.options.topLeft?this.parent.moveCorner(s,n):this.parent.moveCenter(s,n),this.parent.emit("moved",{viewport:this.parent,type:"snap"}),i&&(this.options.removeOnComplete&&this.parent.plugins.remove("snap"),this.parent.emit("snap-end",this.parent),this.snapping=null)}else{const t=this.options.topLeft?this.parent.corner:this.parent.center;t.x===this.x&&t.y===this.y||this.snapStart()}}}const A={width:0,height:0,time:1e3,ease:"easeInOutSine",center:null,interrupt:!0,removeOnComplete:!1,removeOnInterrupts:!1,forceStart:!1,noMove:!1};class k extends d{constructor(t,e={}){super(t),this.options=Object.assign({},A,e),this.ease=L(this.options.ease),this.options.width>0&&(this.xScale=t.screenWidth/this.options.width),this.options.height>0&&(this.yScale=t.screenHeight/this.options.height),this.xIndependent=!!this.xScale,this.yIndependent=!!this.yScale,this.xScale=this.xIndependent?this.xScale:this.yScale,this.yScale=this.yIndependent?this.yScale:this.xScale,0===this.options.time?(t.container.scale.x=this.xScale,t.container.scale.y=this.yScale,this.options.removeOnComplete&&this.parent.plugins.remove("snap-zoom")):e.forceStart&&this.createSnapping()}createSnapping(){this.parent.scale;const t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,i=this.parent.screenWidth/this.xScale,s=this.parent.screenHeight/this.yScale;this.snapping={time:0,startX:t,startY:e,deltaX:i-t,deltaY:s-e},this.parent.emit("snap-zoom-start",this.parent)}resize(){this.snapping=null,this.options.width>0&&(this.xScale=this.parent.screenWidth/this.options.width),this.options.height>0&&(this.yScale=this.parent.screenHeight/this.options.height),this.xScale=this.xIndependent?this.xScale:this.yScale,this.yScale=this.yIndependent?this.yScale:this.xScale}wheel(){this.options.removeOnInterrupt&&this.parent.plugins.remove("snap-zoom")}down(){this.options.removeOnInterrupt?this.parent.plugins.remove("snap-zoom"):this.options.interrupt&&(this.snapping=null)}update(t){if(this.paused)return;if(this.options.interrupt&&0!==this.parent.input.count())return;let e;if(this.options.center||this.options.noMove||(e=this.parent.center),this.snapping){if(this.snapping){const i=this.snapping;if(i.time+=t,i.time>=this.options.time)this.parent.scale.set(this.xScale,this.yScale),this.options.removeOnComplete&&this.parent.plugins.remove("snap-zoom"),this.parent.emit("snap-zoom-end",this.parent),this.snapping=null;else{const t=this.snapping,e=this.ease(t.time,t.startX,t.deltaX,this.options.time),i=this.ease(t.time,t.startY,t.deltaY,this.options.time);this.parent.scale.x=this.parent.screenWidth/e,this.parent.scale.y=this.parent.screenHeight/i}const s=this.parent.plugins.get("clamp-zoom",!0);s&&s.clamp(),this.options.noMove||(this.options.center?this.parent.moveCenter(this.options.center):this.parent.moveCenter(e))}}else this.parent.scale.x===this.xScale&&this.parent.scale.y===this.yScale||this.createSnapping()}resume(){this.snapping=null,super.resume()}}const H={speed:0,acceleration:null,radius:null};class I extends d{constructor(t,e,i={}){super(t),this.target=e,this.options=Object.assign({},H,i),this.velocity={x:0,y:0}}update(t){if(this.paused)return;const e=this.parent.center;let i=this.target.x,s=this.target.y;if(this.options.radius){if(!(Math.sqrt(Math.pow(this.target.y-e.y,2)+Math.pow(this.target.x-e.x,2))>this.options.radius))return;{const t=Math.atan2(this.target.y-e.y,this.target.x-e.x);i=this.target.x-Math.cos(t)*this.options.radius,s=this.target.y-Math.sin(t)*this.options.radius}}const n=i-e.x,o=s-e.y;if(n||o)if(this.options.speed)if(this.options.acceleration){const r=Math.atan2(s-e.y,i-e.x),h=Math.sqrt(Math.pow(n,2)+Math.pow(o,2));if(h){const a=(Math.pow(this.velocity.x,2)+Math.pow(this.velocity.y,2))/(2*this.options.acceleration);this.velocity=h>a?{x:Math.min(this.velocity.x+this.options.acceleration*t,this.options.speed),y:Math.min(this.velocity.y+this.options.acceleration*t,this.options.speed)}:{x:Math.max(this.velocity.x-this.options.acceleration*this.options.speed,0),y:Math.max(this.velocity.y-this.options.acceleration*this.options.speed,0)};const p=Math.cos(r)*this.velocity.x,l=Math.sin(r)*this.velocity.y,d=Math.abs(p)>Math.abs(n)?i:e.x+p,c=Math.abs(l)>Math.abs(o)?s:e.y+l;this.parent.moveCenter(d,c),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}else{const t=Math.atan2(s-e.y,i-e.x),r=Math.cos(t)*this.options.speed,h=Math.sin(t)*this.options.speed,a=Math.abs(r)>Math.abs(n)?i:e.x+r,p=Math.abs(h)>Math.abs(o)?s:e.y+h;this.parent.moveCenter(a,p),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}else this.parent.moveCenter(i,s),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}const N={percent:.1,smooth:!1,interrupt:!0,reverse:!1,center:null,lineHeight:20,axis:"all"};class T extends d{constructor(t,e={}){super(t),this.options=Object.assign({},N,e)}down(){this.options.interrupt&&(this.smoothing=null)}isAxisX(){return["all","x"].includes(this.options.axis)}isAxisY(){return["all","y"].includes(this.options.axis)}update(){if(this.smoothing){const t=this.smoothingCenter,e=this.smoothing;let i;this.options.center||(i=this.parent.toLocal(t)),this.isAxisX()&&(this.parent.scale.x+=e.x),this.isAxisY()&&(this.parent.scale.y+=e.y),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const s=this.parent.plugins.get("clamp-zoom",!0);if(s&&s.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const e=this.parent.toGlobal(i);this.parent.x+=t.x-e.x,this.parent.y+=t.y-e.y}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.smoothingCount++,this.smoothingCount>=this.options.smooth&&(this.smoothing=null)}}wheel(t){if(this.paused)return;let e=this.parent.input.getPointerPosition(t);const i=(this.options.reverse?-1:1)*-t.deltaY*(t.deltaMode?this.options.lineHeight:1)/500,s=Math.pow(2,(1+this.options.percent)*i);if(this.options.smooth){const t={x:this.smoothing?this.smoothing.x*(this.options.smooth-this.smoothingCount):0,y:this.smoothing?this.smoothing.y*(this.options.smooth-this.smoothingCount):0};this.smoothing={x:((this.parent.scale.x+t.x)*s-this.parent.scale.x)/this.options.smooth,y:((this.parent.scale.y+t.y)*s-this.parent.scale.y)/this.options.smooth},this.smoothingCount=0,this.smoothingCenter=e}else{let t;this.options.center||(t=this.parent.toLocal(e)),this.isAxisX()&&(this.parent.scale.x*=s),this.isAxisY()&&(this.parent.scale.y*=s),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const i=this.parent.plugins.get("clamp-zoom",!0);if(i&&i.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const i=this.parent.toGlobal(t);this.parent.x+=e.x-i.x,this.parent.y+=e.y-i.y}}return this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.emit("wheel",{wheel:{dx:t.deltaX,dy:t.deltaY,dz:t.deltaZ},event:t,viewport:this.parent}),!this.parent.options.passiveWheel||void 0}}const P={radius:null,distance:null,top:null,bottom:null,left:null,right:null,speed:8,reverse:!1,noDecelerate:!1,linear:!1,allowButtons:!1};class z extends d{constructor(t,e={}){super(t),this.options=Object.assign({},P,e),this.reverse=this.options.reverse?1:-1,this.radiusSquared=Math.pow(this.options.radius,2),this.resize()}resize(){const t=this.options.distance;null!==t?(this.left=t,this.top=t,this.right=this.parent.worldScreenWidth-t,this.bottom=this.parent.worldScreenHeight-t):this.radius||(this.left=this.options.left,this.top=this.options.top,this.right=null===this.options.right?null:this.parent.worldScreenWidth-this.options.right,this.bottom=null===this.options.bottom?null:this.parent.worldScreenHeight-this.options.bottom)}down(){this.paused||this.options.allowButtons||(this.horizontal=this.vertical=null)}move(t){if(this.paused)return;if("mouse"!==t.data.pointerType&&1!==t.data.identifier||!this.options.allowButtons&&0!==t.data.buttons)return;const e=t.data.global.x,i=t.data.global.y;if(this.radiusSquared){const t=this.parent.toScreen(this.parent.center);if(Math.pow(t.x-e,2)+Math.pow(t.y-i,2)>=this.radiusSquared){const s=Math.atan2(t.y-i,t.x-e);this.options.linear?(this.horizontal=Math.round(Math.cos(s))*this.options.speed*this.reverse*.06,this.vertical=Math.round(Math.sin(s))*this.options.speed*this.reverse*.06):(this.horizontal=Math.cos(s)*this.options.speed*this.reverse*.06,this.vertical=Math.sin(s)*this.options.speed*this.reverse*.06)}else this.horizontal&&this.decelerateHorizontal(),this.vertical&&this.decelerateVertical(),this.horizontal=this.vertical=0}else null!==this.left&&e<this.left?this.horizontal=1*this.reverse*this.options.speed*.06:null!==this.right&&e>this.right?this.horizontal=-1*this.reverse*this.options.speed*.06:(this.decelerateHorizontal(),this.horizontal=0),null!==this.top&&i<this.top?this.vertical=1*this.reverse*this.options.speed*.06:null!==this.bottom&&i>this.bottom?this.vertical=-1*this.reverse*this.options.speed*.06:(this.decelerateVertical(),this.vertical=0)}decelerateHorizontal(){const t=this.parent.plugins.get("decelerate",!0);this.horizontal&&t&&!this.options.noDecelerate&&t.activate({x:this.horizontal*this.options.speed*this.reverse/(1e3/60)})}decelerateVertical(){const t=this.parent.plugins.get("decelerate",!0);this.vertical&&t&&!this.options.noDecelerate&&t.activate({y:this.vertical*this.options.speed*this.reverse/(1e3/60)})}up(){this.paused||(this.horizontal&&this.decelerateHorizontal(),this.vertical&&this.decelerateVertical(),this.horizontal=this.vertical=null)}update(){if(!this.paused&&(this.horizontal||this.vertical)){const t=this.parent.center;this.horizontal&&(t.x+=this.horizontal*this.options.speed),this.vertical&&(t.y+=this.vertical*this.options.speed),this.parent.moveCenter(t),this.parent.emit("moved",{viewport:this.parent,type:"mouse-edges"})}}}const G={removeOnInterrupt:!1,ease:"linear",time:1e3};class j extends d{constructor(t,e={}){super(t),this.options=Object.assign({},G,e),this.options.ease=L(this.options.ease),this.setupPosition(),this.setupZoom()}setupPosition(){void 0!==this.options.position?(this.startX=this.parent.center.x,this.startY=this.parent.center.y,this.deltaX=this.options.position.x-this.parent.center.x,this.deltaY=this.options.position.y-this.parent.center.y,this.keepCenter=!1):this.keepCenter=!0}setupZoom(){this.width=null,this.height=null,void 0!==this.options.scale?this.width=this.parent.screenWidth/this.options.scale:void 0!==this.options.scaleX||void 0!==this.options.scaleY?(void 0!==this.options.scaleX&&(this.width=this.parent.screenWidth/this.options.scaleX),void 0!==this.options.scaleY&&(this.height=this.parent.screenHeight/this.options.scaleY)):(void 0!==this.options.width&&(this.width=this.options.width),void 0!==this.options.height&&(this.height=this.options.height)),null!==typeof this.width&&(this.startWidth=this.parent.screenWidthInWorldPixels,this.deltaWidth=this.width-this.startWidth),null!==typeof this.height&&(this.startHeight=this.parent.screenHeightInWorldPixels,this.deltaHeight=this.height-this.startHeight),this.time=0}down(){this.options.removeOnInterrupt&&this.parent.plugins.remove("animate")}complete(){this.parent.plugins.remove("animate"),null!==this.width&&this.parent.fitWidth(this.width,this.keepCenter,null===this.height),null!==this.height&&this.parent.fitHeight(this.height,this.keepCenter,null===this.width),this.keepCenter||this.parent.moveCenter(this.options.position.x,this.options.position.y),this.parent.emit("animate-end",this.parent),this.options.callbackOnComplete&&this.options.callbackOnComplete(this.parent)}update(t){if(!this.paused)if(this.time+=t,this.time>=this.options.time)this.complete();else{const t=new e.Point(this.parent.scale.x,this.parent.scale.y),i=this.options.ease(this.time,0,1,this.options.time);if(null!==this.width&&this.parent.fitWidth(this.startWidth+this.deltaWidth*i,this.keepCenter,null===this.height),null!==this.height&&this.parent.fitHeight(this.startHeight+this.deltaHeight*i,this.keepCenter,null===this.width),null===this.width?this.parent.scale.x=this.parent.scale.y:null===this.height&&(this.parent.scale.y=this.parent.scale.x),!this.keepCenter){const t=new e.Point(this.parent.x,this.parent.y);this.parent.moveCenter(this.startX+this.deltaX*i,this.startY+this.deltaY*i),this.parent.emit("moved",{viewport:this.parent,original:t,type:"animate"})}(this.width||this.height)&&this.parent.emit("zoomed",{viewport:this.parent,original:t,type:"animate"}),this.keepCenter}}}const D={screenWidth:window.innerWidth,screenHeight:window.innerHeight,worldWidth:null,worldHeight:null,threshold:5,passiveWheel:!0,stopPropagation:!1,forceHitArea:null,noTicker:!1,interaction:null,disableOnContextMenu:!1};class B extends e.Container{constructor(t={}){if(super(),this.options=Object.assign({},D,t),t.ticker)this.options.ticker=t.ticker;else{let i;const s=n;i=parseInt(/^(\d+)\./.exec(e.VERSION)[1])<5?s.ticker.shared:s.Ticker.shared,this.options.ticker=t.ticker||i}this.screenWidth=this.options.screenWidth,this.screenHeight=this.options.screenHeight,this._worldWidth=this.options.worldWidth,this._worldHeight=this.options.worldHeight,this.forceHitArea=this.options.forceHitArea,this.threshold=this.options.threshold,this.options.divWheel=this.options.divWheel||document.body,this.options.disableOnContextMenu&&(this.options.divWheel.oncontextmenu=t=>t.preventDefault()),this.options.noTicker||(this.tickerFunction=()=>this.update(this.options.ticker.elapsedMS),this.options.ticker.add(this.tickerFunction)),this.input=new a(this),this.plugins=new l(this)}destroy(t){this.options.noTicker||this.options.ticker.remove(this.tickerFunction),this.input.destroy(),super.destroy(t)}update(t){this.pause||(this.plugins.update(t),this.lastViewport&&(this.lastViewport.x!==this.x||this.lastViewport.y!==this.y?this.moving=!0:this.moving&&(this.emit("moved-end",this),this.moving=!1),this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y?this.zooming=!0:this.zooming&&(this.emit("zoomed-end",this),this.zooming=!1)),this.forceHitArea||(this._hitAreaDefault=new e.Rectangle(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight),this.hitArea=this._hitAreaDefault),this._dirty=this._dirty||!this.lastViewport||this.lastViewport.x!==this.x||this.lastViewport.y!==this.y||this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y,this.lastViewport={x:this.x,y:this.y,scaleX:this.scale.x,scaleY:this.scale.y},this.emit("frame-end",this))}resize(t=window.innerWidth,e=window.innerHeight,i,s){this.screenWidth=t,this.screenHeight=e,void 0!==i&&(this._worldWidth=i),void 0!==s&&(this._worldHeight=s),this.plugins.resize(),this.dirty=!0}get worldWidth(){return this._worldWidth?this._worldWidth:this.width/this.scale.x}set worldWidth(t){this._worldWidth=t,this.plugins.resize()}get worldHeight(){return this._worldHeight?this._worldHeight:this.height/this.scale.y}set worldHeight(t){this._worldHeight=t,this.plugins.resize()}getVisibleBounds(){return new e.Rectangle(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight)}toWorld(t,i){return 2===arguments.length?this.toLocal(new e.Point(t,i)):this.toLocal(t)}toScreen(t,i){return 2===arguments.length?this.toGlobal(new e.Point(t,i)):this.toGlobal(t)}get worldScreenWidth(){return this.screenWidth/this.scale.x}get worldScreenHeight(){return this.screenHeight/this.scale.y}get screenWorldWidth(){return this.worldWidth*this.scale.x}get screenWorldHeight(){return this.worldHeight*this.scale.y}get center(){return new e.Point(this.worldScreenWidth/2-this.x/this.scale.x,this.worldScreenHeight/2-this.y/this.scale.y)}set center(t){this.moveCenter(t)}moveCenter(){let t,e;isNaN(arguments[0])?(t=arguments[0].x,e=arguments[0].y):(t=arguments[0],e=arguments[1]);const i=(this.worldScreenWidth/2-t)*this.scale.x,s=(this.worldScreenHeight/2-e)*this.scale.y;return this.x===i&&this.y===s||(this.position.set(i,s),this.plugins.reset(),this.dirty=!0),this}get corner(){return new e.Point(-this.x/this.scale.x,-this.y/this.scale.y)}set corner(t){this.moveCorner(t)}moveCorner(){let t,e;return 1===arguments.length?(t=-arguments[0].x*this.scale.x,e=-arguments[0].y*this.scale.y):(t=-arguments[0]*this.scale.x,e=-arguments[1]*this.scale.y),t===this.x&&e===this.y||(this.position.set(t,e),this.plugins.reset(),this.dirty=!0),this}get screenWidthInWorldPixels(){return this.screenWidth/this.scale.x}get screenHeightInWorldPixels(){return this.screenHeight/this.scale.y}findFitWidth(t){return this.screenWidth/t}findFitHeight(t){return this.screenHeight/t}findFit(t,e){const i=this.screenWidth/t,s=this.screenHeight/e;return Math.min(i,s)}findCover(t,e){const i=this.screenWidth/t,s=this.screenHeight/e;return Math.max(i,s)}fitWidth(t,e,i=!0,s){let n;e&&(n=this.center),this.scale.x=this.screenWidth/t,i&&(this.scale.y=this.scale.x);const o=this.plugins.get("clamp-zoom",!0);return!s&&o&&o.clamp(),e&&this.moveCenter(n),this}fitHeight(t,e,i=!0,s){let n;e&&(n=this.center),this.scale.y=this.screenHeight/t,i&&(this.scale.x=this.scale.y);const o=this.plugins.get("clamp-zoom",!0);return!s&&o&&o.clamp(),e&&this.moveCenter(n),this}fitWorld(t){let e;t&&(e=this.center),this.scale.x=this.screenWidth/this.worldWidth,this.scale.y=this.screenHeight/this.worldHeight,this.scale.x<this.scale.y?this.scale.y=this.scale.x:this.scale.x=this.scale.y;const i=this.plugins.get("clamp-zoom",!0);return i&&i.clamp(),t&&this.moveCenter(e),this}fit(t,e=this.worldWidth,i=this.worldHeight){let s;t&&(s=this.center),this.scale.x=this.screenWidth/e,this.scale.y=this.screenHeight/i,this.scale.x<this.scale.y?this.scale.y=this.scale.x:this.scale.x=this.scale.y;const n=this.plugins.get("clamp-zoom",!0);return n&&n.clamp(),t&&this.moveCenter(s),this}set visible(t){t||this.input.clear(),super.visible=t}setZoom(t,e){let i;e&&(i=this.center),this.scale.set(t);const s=this.plugins.get("clamp-zoom",!0);return s&&s.clamp(),e&&this.moveCenter(i),this}zoomPercent(t,e){return this.setZoom(this.scale.x+this.scale.x*t,e)}zoom(t,e){return this.fitWidth(t+this.worldScreenWidth,e),this}set scaled(t){this.setZoom(t,!0)}get scaled(){return this.scale.x}snapZoom(t){return this.plugins.add("snap-zoom",new k(this,t)),this}OOB(){return{left:this.left<0,right:this.right>this.worldWidth,top:this.top<0,bottom:this.bottom>this._worldHeight,cornerPoint:new e.Point(this.worldWidth*this.scale.x-this.screenWidth,this.worldHeight*this.scale.y-this.screenHeight)}}get right(){return-this.x/this.scale.x+this.worldScreenWidth}set right(t){this.x=-t*this.scale.x+this.screenWidth,this.plugins.reset()}get left(){return-this.x/this.scale.x}set left(t){this.x=-t*this.scale.x,this.plugins.reset()}get top(){return-this.y/this.scale.y}set top(t){this.y=-t*this.scale.y,this.plugins.reset()}get bottom(){return-this.y/this.scale.y+this.worldScreenHeight}set bottom(t){this.y=-t*this.scale.y+this.screenHeight,this.plugins.reset()}get dirty(){return this._dirty}set dirty(t){this._dirty=t}get forceHitArea(){return this._forceHitArea}set forceHitArea(t){t?(this._forceHitArea=t,this.hitArea=t):(this._forceHitArea=null,this.hitArea=new e.Rectangle(0,0,this.worldWidth,this.worldHeight))}drag(t){return this.plugins.add("drag",new u(this,t)),this}clamp(t){return this.plugins.add("clamp",new m(this,t)),this}decelerate(t){return this.plugins.add("decelerate",new M(this,t)),this}bounce(t){return this.plugins.add("bounce",new W(this,t)),this}pinch(t){return this.plugins.add("pinch",new g(this,t)),this}snap(t,e,i){return this.plugins.add("snap",new S(this,t,e,i)),this}follow(t,e){return this.plugins.add("follow",new I(this,t,e)),this}wheel(t){return this.plugins.add("wheel",new T(this,t)),this}animate(t){return this.plugins.add("animate",new j(this,t)),this}clampZoom(t){return this.plugins.add("clamp-zoom",new w(this,t)),this}mouseEdges(t){return this.plugins.add("mouse-edges",new z(this,t)),this}get pause(){return this._pause}set pause(t){this._pause=t,this.lastViewport=null,this.moving=!1,this.zooming=!1,t&&this.input.pause()}ensureVisible(t,e,i,s,n){n&&(i>this.worldScreenWidth||s>this.worldScreenHeight)&&(this.fit(!0,i,s),this.emit("zoomed",{viewport:this,type:"ensureVisible"}));let o=!1;t<this.left?(this.left=t,o=!0):t+i>this.right&&(this.right=t+i,o=!0),e<this.top?(this.top=e,o=!0):e+s>this.bottom&&(this.bottom=e+s,o=!0),o&&this.emit("moved",{viewport:this,type:"ensureVisible"})}}
/*!
   * @pixi/math - v5.3.9
   * Compiled Wed, 24 Mar 2021 19:54:16 UTC
   *
   * @pixi/math is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   */var X,Y=2*Math.PI;!function(t){t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC"}(X||(X={}));var R=function(){function t(t,e,i,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=0),this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(s),this.type=X.RECT}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(t,"EMPTY",{get:function(){return new t(0,0,0,0)},enumerable:!1,configurable:!0}),t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},t.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)},t.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},t.prototype.fit=function(t){var e=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),s=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=s,this.height=Math.max(n-s,0),this},t.prototype.ceil=function(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var i=Math.ceil((this.x+this.width-e)*t)/t,s=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=s-this.y,this},t.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),s=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=s,this.height=n-s,this},t}(),U=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},t.prototype.copyTo=function(t){return t.set(this.x,this.y),t},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this},t}(),K=function(){function t(t,e,i,s){void 0===i&&(i=0),void 0===s&&(s=0),this._x=i,this._y=s,this.cb=t,this.scope=e}return t.prototype.clone=function(e,i){return void 0===e&&(e=this.cb),void 0===i&&(i=this.scope),new t(e,i,this._x,this._y)},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope)),this},t.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},t.prototype.copyTo=function(t){return t.set(this._x,this._y),t},t.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),t}(),F=function(){function t(t,e,i,s,n,o){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=1),void 0===n&&(n=0),void 0===o&&(o=0),this.array=null,this.a=t,this.b=e,this.c=i,this.d=s,this.tx=n,this.ty=o}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.set=function(t,e,i,s,n,o){return this.a=t,this.b=e,this.c=i,this.d=s,this.tx=n,this.ty=o,this},t.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i},t.prototype.apply=function(t,e){e=e||new U;var i=t.x,s=t.y;return e.x=this.a*i+this.c*s+this.tx,e.y=this.b*i+this.d*s+this.ty,e},t.prototype.applyInverse=function(t,e){e=e||new U;var i=1/(this.a*this.d+this.c*-this.b),s=t.x,n=t.y;return e.x=this.d*i*s+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*n+-this.b*i*s+(-this.ty*this.a+this.tx*this.b)*i,e},t.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},t.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),s=this.a,n=this.c,o=this.tx;return this.a=s*e-this.b*i,this.b=s*i+this.b*e,this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=o*e-this.ty*i,this.ty=o*i+this.ty*e,this},t.prototype.append=function(t){var e=this.a,i=this.b,s=this.c,n=this.d;return this.a=t.a*e+t.b*s,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*s,this.d=t.c*i+t.d*n,this.tx=t.tx*e+t.ty*s+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this},t.prototype.setTransform=function(t,e,i,s,n,o,r,h,a){return this.a=Math.cos(r+a)*n,this.b=Math.sin(r+a)*n,this.c=-Math.sin(r-h)*o,this.d=Math.cos(r-h)*o,this.tx=t-(i*this.a+s*this.c),this.ty=e-(i*this.b+s*this.d),this},t.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,s=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=s*t.a+this.d*t.c,this.d=s*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},t.prototype.decompose=function(t){var e=this.a,i=this.b,s=this.c,n=this.d,o=-Math.atan2(-s,n),r=Math.atan2(i,e),h=Math.abs(o+r);return h<1e-5||Math.abs(Y-h)<1e-5?(t.rotation=r,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=o,t.skew.y=r),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(s*s+n*n),t.position.x=this.tx,t.position.y=this.ty,t},t.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,s=this.d,n=this.tx,o=t*s-e*i;return this.a=s/o,this.b=-e/o,this.c=-i/o,this.d=t/o,this.tx=(i*this.ty-s*n)/o,this.ty=-(t*this.ty-e*n)/o,this},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},t.prototype.clone=function(){var e=new t;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},t.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(t,"IDENTITY",{get:function(){return new t},enumerable:!1,configurable:!0}),Object.defineProperty(t,"TEMP_MATRIX",{get:function(){return new t},enumerable:!1,configurable:!0}),t}(),V=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],q=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Z=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Q=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],$=Math.sign;!function(){for(var t=0;t<16;t++)for(var e=[],i=0;i<16;i++)for(var s=$(V[t]*V[i]+Z[t]*q[i]),n=$(q[t]*V[i]+Q[t]*q[i]),o=$(V[t]*Z[i]+Z[t]*Q[i]),r=$(q[t]*Z[i]+Q[t]*Q[i]),h=0;h<16;h++)if(V[h]===s&&q[h]===n&&Z[h]===o&&Q[h]===r){e.push(h);break}for(t=0;t<16;t++){(new F).set(V[t],q[t],Z[t],Q[t],0,0)}}(),function(){function t(){this.worldTransform=new F,this.localTransform=new F,this.position=new K(this.onChange,this,0,0),this.scale=new K(this.onChange,this,1,1),this.pivot=new K(this.onChange,this,0,0),this.skew=new K(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}t.prototype.onChange=function(){this._localID++},t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},t.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},t.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,s=this.worldTransform;s.a=e.a*i.a+e.b*i.c,s.b=e.a*i.b+e.b*i.d,s.c=e.c*i.a+e.d*i.c,s.d=e.c*i.b+e.d*i.d,s.tx=e.tx*i.a+e.ty*i.c+i.tx,s.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},t.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!1,configurable:!0}),t.IDENTITY=new t}();const J=new R;class tt{constructor(t={}){this._recursive="boolean"!=typeof t.recursive||t.recursive,this._toggle=t.toggle||"visible",this._targetList=new Set}add(t){return this._targetList.add(t),this}addAll(t){for(let e=0,i=t.length;e<i;e++)this._targetList.add(t[e]);return this}remove(t){return this._targetList.delete(t),this}removeAll(t){for(let e=0,i=t.length;e<i;e++)this._targetList.delete(t[e]);return this}clear(){return this._targetList.clear(),this}cull(t,e=!1){return e||this.uncull(),this._targetList.forEach((i=>{e||i.getBounds(!1,J),this._recursive?this.cullRecursive(t,i,e):(e&&i._bounds.getRectangle(t),i[this._toggle]=J.right>t.left&&J.left<t.right&&J.bottom>t.top&&J.top<t.bottom)})),this}uncull(){return this._targetList.forEach((t=>{this._recursive?this.uncullRecursive(t):t[this._toggle]=!1})),this}cullRecursive(t,e,i){const s=i?e._bounds.getRectangle(J):e.getBounds(!0,J);e[this._toggle]=s.right>t.left&&s.left<t.right&&s.bottom>t.top&&s.top<t.bottom;if(!(s.left>=t.left&&s.top>=t.top&&s.right<=t.right&&s.bottom<=t.bottom)&&e[this._toggle]&&e.children&&e.children.length){const i=e.children;for(let e=0,s=i.length;e<s;e++)this.cullRecursive(t,i[e])}}uncullRecursive(t){if(t[this._toggle]=!0,t.children&&t.children.length){const e=t.children;for(let t=0,i=e.length;t<i;t++)this.uncullRecursive(e[t])}}}var et,it="object"==typeof Reflect?Reflect:null,st=it&&"function"==typeof it.apply?it.apply:function(t,e,i){return Function.prototype.apply.call(t,e,i)};et=it&&"function"==typeof it.ownKeys?it.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var nt=Number.isNaN||function(t){return t!=t};function ot(){ot.init.call(this)}var rt=ot,ht=function(t,e){return new Promise((function(i,s){function n(i){t.removeListener(e,o),s(i)}function o(){"function"==typeof t.removeListener&&t.removeListener("error",n),i([].slice.call(arguments))}mt(t,e,o,{once:!0}),"error"!==e&&function(t,e,i){"function"==typeof t.on&&mt(t,"error",e,i)}(t,n,{once:!0})}))};ot.EventEmitter=ot,ot.prototype._events=void 0,ot.prototype._eventsCount=0,ot.prototype._maxListeners=void 0;var at=10;function pt(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function lt(t){return void 0===t._maxListeners?ot.defaultMaxListeners:t._maxListeners}function dt(t,e,i,s){var n,o,r,h;if(pt(i),void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,i.listener?i.listener:i),o=t._events),r=o[e]),void 0===r)r=o[e]=i,++t._eventsCount;else if("function"==typeof r?r=o[e]=s?[i,r]:[r,i]:s?r.unshift(i):r.push(i),(n=lt(t))>0&&r.length>n&&!r.warned){r.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+r.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=r.length,h=a,console&&console.warn&&console.warn(h)}return t}function ct(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function ut(t,e,i){var s={fired:!1,wrapFn:void 0,target:t,type:e,listener:i},n=ct.bind(s);return n.listener=i,s.wrapFn=n,n}function ft(t,e,i){var s=t._events;if(void 0===s)return[];var n=s[e];return void 0===n?[]:"function"==typeof n?i?[n.listener||n]:[n]:i?function(t){for(var e=new Array(t.length),i=0;i<e.length;++i)e[i]=t[i].listener||t[i];return e}(n):yt(n,n.length)}function gt(t){var e=this._events;if(void 0!==e){var i=e[t];if("function"==typeof i)return 1;if(void 0!==i)return i.length}return 0}function yt(t,e){for(var i=new Array(e),s=0;s<e;++s)i[s]=t[s];return i}function mt(t,e,i,s){if("function"==typeof t.on)s.once?t.once(e,i):t.on(e,i);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function n(o){s.once&&t.removeEventListener(e,n),i(o)}))}}Object.defineProperty(ot,"defaultMaxListeners",{enumerable:!0,get:function(){return at},set:function(t){if("number"!=typeof t||t<0||nt(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");at=t}}),ot.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},ot.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||nt(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},ot.prototype.getMaxListeners=function(){return lt(this)},ot.prototype.emit=function(t){for(var e=[],i=1;i<arguments.length;i++)e.push(arguments[i]);var s="error"===t,n=this._events;if(void 0!==n)s=s&&void 0===n.error;else if(!s)return!1;if(s){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var r=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw r.context=o,r}var h=n[t];if(void 0===h)return!1;if("function"==typeof h)st(h,this,e);else{var a=h.length,p=yt(h,a);for(i=0;i<a;++i)st(p[i],this,e)}return!0},ot.prototype.addListener=function(t,e){return dt(this,t,e,!1)},ot.prototype.on=ot.prototype.addListener,ot.prototype.prependListener=function(t,e){return dt(this,t,e,!0)},ot.prototype.once=function(t,e){return pt(e),this.on(t,ut(this,t,e)),this},ot.prototype.prependOnceListener=function(t,e){return pt(e),this.prependListener(t,ut(this,t,e)),this},ot.prototype.removeListener=function(t,e){var i,s,n,o,r;if(pt(e),void 0===(s=this._events))return this;if(void 0===(i=s[t]))return this;if(i===e||i.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete s[t],s.removeListener&&this.emit("removeListener",t,i.listener||e));else if("function"!=typeof i){for(n=-1,o=i.length-1;o>=0;o--)if(i[o]===e||i[o].listener===e){r=i[o].listener,n=o;break}if(n<0)return this;0===n?i.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(i,n),1===i.length&&(s[t]=i[0]),void 0!==s.removeListener&&this.emit("removeListener",t,r||e)}return this},ot.prototype.off=ot.prototype.removeListener,ot.prototype.removeAllListeners=function(t){var e,i,s;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete i[t]),this;if(0===arguments.length){var n,o=Object.keys(i);for(s=0;s<o.length;++s)"removeListener"!==(n=o[s])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=i[t]))this.removeListener(t,e);else if(void 0!==e)for(s=e.length-1;s>=0;s--)this.removeListener(t,e[s]);return this},ot.prototype.listeners=function(t){return ft(this,t,!0)},ot.prototype.rawListeners=function(t){return ft(this,t,!1)},ot.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):gt.call(t,e)},ot.prototype.listenerCount=gt,ot.prototype.eventNames=function(){return this._eventsCount>0?et(this._events):[]},rt.once=ht;var vt=function(t,e,i){return t(i={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&i.path)}},i.exports),i.exports}((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.TypedEmitter=rt.EventEmitter})),wt=function(t){return function(t){return!!t&&"object"==typeof t}(t)&&!function(t){var e=Object.prototype.toString.call(t);return"[object RegExp]"===e||"[object Date]"===e||function(t){return t.$$typeof===xt}(t)}(t)};var xt="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function bt(t,e){return!1!==e.clone&&e.isMergeableObject(t)?Ot((i=t,Array.isArray(i)?[]:{}),t,e):t;var i}function Mt(t,e,i){return t.concat(e).map((function(t){return bt(t,i)}))}function Ct(t){return Object.keys(t).concat(function(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter((function(e){return t.propertyIsEnumerable(e)})):[]}(t))}function Et(t,e){try{return e in t}catch(t){return!1}}function Lt(t,e,i){var s={};return i.isMergeableObject(t)&&Ct(t).forEach((function(e){s[e]=bt(t[e],i)})),Ct(e).forEach((function(n){(function(t,e){return Et(t,e)&&!(Object.hasOwnProperty.call(t,e)&&Object.propertyIsEnumerable.call(t,e))})(t,n)||(Et(t,n)&&i.isMergeableObject(e[n])?s[n]=function(t,e){if(!e.customMerge)return Ot;var i=e.customMerge(t);return"function"==typeof i?i:Ot}(n,i)(t[n],e[n],i):s[n]=bt(e[n],i))})),s}function Ot(t,e,i){(i=i||{}).arrayMerge=i.arrayMerge||Mt,i.isMergeableObject=i.isMergeableObject||wt,i.cloneUnlessOtherwiseSpecified=bt;var s=Array.isArray(e);return s===Array.isArray(t)?s?i.arrayMerge(t,e,i):Lt(t,e,i):bt(e,i)}Ot.all=function(t,e){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce((function(t,i){return Ot(t,i,e)}),{})};var Wt=Ot;function _t(t,e){return t instanceof Function?t(e):"object"==typeof t&&null!==t?Object.fromEntries(Object.entries(t).map((function(t){return[t[0],_t(t[1],e)]}))):t}function St(t,e){var i=t.filter((function(t){return!!t})).map((function(t){return _t(t,e)}));return Wt.all(i)}var At=function(){function t(t){this.textures=new Map,this.app=t}return t.prototype.get=function(t,e){var i=this.textures.get(t);if(!i){var s=e(),o=s.getLocalBounds(void 0,!0),r=new n.Rectangle(Math.floor(o.x),Math.floor(o.y),Math.ceil(o.width),Math.ceil(o.height));i=this.app.renderer.generateTexture(s,n.SCALE_MODES.LINEAR,this.app.renderer.resolution,r),this.textures.set(t,i)}return i},t.prototype.delete=function(t){var e=this.textures.get(t);e&&(e.destroy(),this.textures.delete(t))},t.prototype.clear=function(){var t=this;Array.from(this.textures.keys()).forEach((function(e){t.delete(e)}))},t.prototype.destroy=function(){this.clear()},t}(),kt={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Ht={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function It(t){var e,i,s=[],n=1;if("string"==typeof t)if(kt[t])s=kt[t].slice(),i="rgb";else if("transparent"===t)n=0,i="rgb",s=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(t)){var o=t.slice(1);n=1,(a=o.length)<=4?(s=[parseInt(o[0]+o[0],16),parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16)],4===a&&(n=parseInt(o[3]+o[3],16)/255)):(s=[parseInt(o[0]+o[1],16),parseInt(o[2]+o[3],16),parseInt(o[4]+o[5],16)],8===a&&(n=parseInt(o[6]+o[7],16)/255)),s[0]||(s[0]=0),s[1]||(s[1]=0),s[2]||(s[2]=0),i="rgb"}else if(e=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(t)){var r=e[1],h="rgb"===r;i=o=r.replace(/a$/,"");var a="cmyk"===o?4:"gray"===o?1:3;s=e[2].trim().split(/\s*[,\/]\s*|\s+/).map((function(t,e){if(/%$/.test(t))return e===a?parseFloat(t)/100:"rgb"===o?255*parseFloat(t)/100:parseFloat(t);if("h"===o[e]){if(/deg$/.test(t))return parseFloat(t);if(void 0!==Ht[t])return Ht[t]}return parseFloat(t)})),r===o&&s.push(1),n=h||void 0===s[a]?1:s[a],s=s.slice(0,a)}else t.length>10&&/[0-9](?:\s|\/)/.test(t)&&(s=t.match(/([0-9]+)/g).map((function(t){return parseFloat(t)})),i=t.match(/([a-z])/gi).join("").toLowerCase());else isNaN(t)?Array.isArray(t)||t.length?(s=[t[0],t[1],t[2]],i="rgb",n=4===t.length?t[3]:1):t instanceof Object&&(null!=t.r||null!=t.red||null!=t.R?(i="rgb",s=[t.r||t.red||t.R||0,t.g||t.green||t.G||0,t.b||t.blue||t.B||0]):(i="hsl",s=[t.h||t.hue||t.H||0,t.s||t.saturation||t.S||0,t.l||t.lightness||t.L||t.b||t.brightness]),n=t.a||t.alpha||t.opacity||1,null!=t.opacity&&(n/=100)):(i="rgb",s=[t>>>16,(65280&t)>>>8,255&t]);return{space:i,values:s,alpha:n}}var Nt=function(t){var e,i,s,n,o,r=t[0]/360,h=t[1]/100,a=t[2]/100;if(0===h)return[o=255*a,o,o];e=2*a-(i=a<.5?a*(1+h):a+h-a*h),n=[0,0,0];for(var p=0;p<3;p++)(s=r+1/3*-(p-1))<0?s++:s>1&&s--,o=6*s<1?e+6*(i-e)*s:2*s<1?i:3*s<2?e+(i-e)*(2/3-s)*6:e,n[p]=255*o;return n};function Tt(t){var e=function(t){var e;Array.isArray(t)&&t.raw&&(t=String.raw(...arguments));var i=It(t);return i.space?((e=Array(3))[0]=Math.min(Math.max(i.values[0],0),255),e[1]=Math.min(Math.max(i.values[1],0),255),e[2]=Math.min(Math.max(i.values[2],0),255),"h"===i.space[0]&&(e=Nt(e)),e.push(Math.min(Math.max(i.alpha,0),1)),e):[]}(t);if(!e)throw new Error("Invalid color "+t);return[n.utils.rgb2hex([e[0]/255,e[1]/255,e[2]/255]),e[3]]}var Pt="::",zt=16777215,Gt="NODE_CIRCLE",jt="NODE_CIRCLE_BORDER",Dt="NODE_ICON";var Bt="NODE_LABEL_BACKGROUND",Xt="NODE_LABEL_TEXT";var Yt=function(t){function e(){var e=t.call(this)||this;return e.hovered=!1,e.nodeGfx=e.createNode(),e.nodeLabelGfx=e.createNodeLabel(),e.nodePlaceholderGfx=new n.Container,e.nodeLabelPlaceholderGfx=new n.Container,e}return h(e,t),e.prototype.createNode=function(){var t=this,e=new n.Container;return e.interactive=!0,e.buttonMode=!0,e.on("mousemove",(function(e){return t.emit("mousemove",e.data.originalEvent)})),e.on("mouseover",(function(e){return t.emit("mouseover",e.data.originalEvent)})),e.on("mouseout",(function(e){return t.emit("mouseout",e.data.originalEvent)})),e.on("mousedown",(function(e){return t.emit("mousedown",e.data.originalEvent)})),e.on("mouseup",(function(e){return t.emit("mouseup",e.data.originalEvent)})),function(t){t.hitArea=new n.Circle(0,0);var e=new n.Sprite;e.name=Gt,e.anchor.set(.5),t.addChild(e);var i=new n.Sprite;i.name=jt,i.anchor.set(.5),t.addChild(i);var s=new n.Sprite;s.name=Dt,s.anchor.set(.5),t.addChild(s)}(e),e},e.prototype.createNodeLabel=function(){var t=this,e=new n.Container;return e.interactive=!0,e.buttonMode=!0,e.on("mousemove",(function(e){return t.emit("mousemove",e.data.originalEvent)})),e.on("mouseover",(function(e){return t.emit("mouseover",e.data.originalEvent)})),e.on("mouseout",(function(e){return t.emit("mouseout",e.data.originalEvent)})),e.on("mousedown",(function(e){return t.emit("mousedown",e.data.originalEvent)})),e.on("mouseup",(function(e){return t.emit("mouseup",e.data.originalEvent)})),function(t){var e=new n.Sprite(n.Texture.WHITE);e.name=Bt,e.anchor.set(.5),t.addChild(e);var i=new n.Sprite;i.name=Xt,i.anchor.set(.5),t.addChild(i)}(e),e},e.prototype.updatePosition=function(t){this.nodeGfx.position.copyFrom(t),this.nodeLabelGfx.position.copyFrom(t)},e.prototype.updateStyle=function(t,e){!function(t,e,i){var s,r,h,a=e.size+e.border.width,p=[Gt,e.size].join(Pt),l=i.get(p,(function(){var t=new n.Graphics;return t.beginFill(zt),t.drawCircle(e.size,e.size,e.size),t})),d=[jt,e.size,e.border.width].join(Pt),c=i.get(d,(function(){var t=new n.Graphics;return t.lineStyle(e.border.width,zt),t.drawCircle(a,a,e.size),t})),u=[Dt,e.icon.fontFamily,e.icon.fontSize,e.icon.content].join(Pt),f=i.get(u,(function(){return o(e.icon.type,e.icon.content,{fontFamily:e.icon.fontFamily,fontSize:e.icon.fontSize})}));t.hitArea.radius=a;var g=t.getChildByName(Gt);g.texture=l,s=Tt(e.color),g.tint=s[0],g.alpha=s[1];var y=t.getChildByName(jt);y.texture=c,r=Tt(e.border.color),y.tint=r[0],y.alpha=r[1];var m=t.getChildByName(Dt);m.texture=f,h=Tt(e.icon.color),m.tint=h[0],m.alpha=h[1],t.addChild(m)}(this.nodeGfx,t,e),function(t,e,i){var s,n,r=e.size+e.border.width,h=[Xt,e.label.fontFamily,e.label.fontSize,e.label.content].join("::"),a=i.get(h,(function(){return o(e.label.type,e.label.content,{fontFamily:e.label.fontFamily,fontSize:e.label.fontSize})})),p=t.getChildByName(Bt);p.y=r+(a.height+2*e.label.padding)/2,p.width=a.width+2*e.label.padding,p.height=a.height+2*e.label.padding,s=Tt(e.label.backgroundColor),p.tint=s[0],p.alpha=s[1];var l=t.getChildByName(Xt);l.texture=a,l.y=r+(a.height+2*e.label.padding)/2,n=Tt(e.label.color),l.tint=n[0],l.alpha=n[1]}(this.nodeLabelGfx,t,e)},e.prototype.updateVisibility=function(t){!function(t,e){var i=t.getChildByName(jt);i.visible=i.visible&&e>=1;var s=t.getChildByName(Dt);s.visible=s.visible&&e>=2}(this.nodeGfx,t),function(t,e){var i=t.getChildByName(Bt);i.visible=i.visible&&e>=3;var s=t.getChildByName(Xt);s.visible=s.visible&&e>=3}(this.nodeLabelGfx,t)},e}(vt.TypedEmitter),Rt="EDGE_LINE";var Ut=function(t){function e(){var e=t.call(this)||this;return e.hovered=!1,e.edgeGfx=e.createEdge(),e.edgePlaceholderGfx=new n.Container,e}return h(e,t),e.prototype.createEdge=function(){var t=this,e=new n.Container;return e.interactive=!0,e.buttonMode=!0,e.on("mousemove",(function(e){return t.emit("mousemove",e.data.originalEvent)})),e.on("mouseover",(function(e){return t.emit("mouseover",e.data.originalEvent)})),e.on("mouseout",(function(e){return t.emit("mouseout",e.data.originalEvent)})),e.on("mousedown",(function(e){return t.emit("mousedown",e.data.originalEvent)})),e.on("mouseup",(function(e){return t.emit("mouseup",e.data.originalEvent)})),function(t){var e=new n.Sprite(n.Texture.WHITE);e.name=Rt,e.anchor.set(.5),t.addChild(e)}(e),e},e.prototype.updatePosition=function(t,e){var i={x:(t.x+e.x)/2,y:(t.y+e.y)/2},s=-Math.atan2(e.x-t.x,e.y-t.y),n=Math.hypot(e.x-t.x,e.y-t.y);this.edgeGfx.position.copyFrom(i),this.edgeGfx.rotation=s,this.edgeGfx.height=n},e.prototype.updateStyle=function(t,e){!function(t,e,i){var s,n=t.getChildByName(Rt);n.width=e.width,s=Tt(e.color),n.tint=s[0],n.alpha=s[1]}(this.edgeGfx,t)},e.prototype.updateVisibility=function(t){!function(t,e){var i=t.getChildByName(Rt);i.visible=i.visible&&e>=1}(this.edgeGfx,t)},e}(vt.TypedEmitter),Kt={node:{size:15,color:"#000000",border:{width:2,color:"#ffffff"},icon:{type:t.TextType.TEXT,fontFamily:"Arial",fontSize:20,color:"#ffffff",content:""},label:{type:t.TextType.TEXT,fontFamily:"Arial",fontSize:12,content:"",color:"#333333",backgroundColor:"rgba(0, 0, 0, 0)",padding:4}},edge:{width:1,color:"#cccccc"}},Ft=function(t){function e(e){var i=t.call(this)||this;if(i.nodeKeyToNodeObject=new Map,i.edgeKeyToEdgeObject=new Map,i.mousedownNodeKey=null,i.mousedownEdgeKey=null,i.onGraphNodeAddedBound=i.onGraphNodeAdded.bind(i),i.onGraphEdgeAddedBound=i.onGraphEdgeAdded.bind(i),i.onGraphNodeDroppedBound=i.onGraphNodeDropped.bind(i),i.onGraphEdgeDroppedBound=i.onGraphEdgeDropped.bind(i),i.onGraphClearedBound=i.onGraphCleared.bind(i),i.onGraphEdgesClearedBound=i.onGraphEdgesCleared.bind(i),i.onGraphNodeAttributesUpdatedBound=i.onGraphNodeAttributesUpdated.bind(i),i.onGraphEdgeAttributesUpdatedBound=i.onGraphEdgeAttributesUpdated.bind(i),i.onGraphEachNodeAttributesUpdatedBound=i.onGraphEachNodeAttributesUpdated.bind(i),i.onGraphEachEdgeAttributesUpdatedBound=i.onGraphEachEdgeAttributesUpdated.bind(i),i.onDocumentMouseMoveBound=i.onDocumentMouseMove.bind(i),i.onDocumentMouseUpBound=i.onDocumentMouseUp.bind(i),i.container=e.container,i.graph=e.graph,i.style=e.style,i.hoverStyle=e.hoverStyle,i.resources=e.resources,i.nodeDragging="boolean"!=typeof e.nodeDragging||e.nodeDragging,n.settings.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1,!(i.container instanceof HTMLElement))throw new Error("container should be a HTMLElement");return i.app=new n.Application({resizeTo:i.container,resolution:window.devicePixelRatio,transparent:!0,antialias:!0,autoDensity:!0}),i.container.appendChild(i.app.view),i.app.renderer.plugins.interaction.moveWhenInside=!0,i.app.view.addEventListener("wheel",(function(t){t.preventDefault()})),i.textureCache=new At(i.app),i.viewport=new B({screenWidth:i.container.clientWidth,screenHeight:i.container.clientHeight,interaction:i.app.renderer.plugins.interaction}).drag().pinch().wheel().decelerate().clampZoom({maxScale:1}),i.app.stage.addChild(i.viewport),i.edgeLayer=new n.Container,i.frontEdgeLayer=new n.Container,i.nodeLayer=new n.Container,i.nodeLabelLayer=new n.Container,i.frontNodeLayer=new n.Container,i.frontNodeLabelLayer=new n.Container,i.viewport.addChild(i.edgeLayer),i.viewport.addChild(i.frontEdgeLayer),i.viewport.addChild(i.nodeLayer),i.viewport.addChild(i.nodeLabelLayer),i.viewport.addChild(i.frontNodeLayer),i.viewport.addChild(i.frontNodeLabelLayer),i.resizeObserver=new ResizeObserver((function(){i.app.resize(),i.viewport.resize(i.container.clientWidth,i.container.clientHeight),i.updateGraphVisibility()})),i.resources&&i.app.loader.add(i.resources),i.app.loader.load((function(){i.viewport.on("frame-end",(function(){i.viewport.dirty&&(i.updateGraphVisibility(),i.viewport.dirty=!1)})),i.resizeObserver.observe(i.container),i.graph.on("nodeAdded",i.onGraphNodeAddedBound),i.graph.on("edgeAdded",i.onGraphEdgeAddedBound),i.graph.on("nodeDropped",i.onGraphNodeDroppedBound),i.graph.on("edgeDropped",i.onGraphEdgeDroppedBound),i.graph.on("cleared",i.onGraphClearedBound),i.graph.on("edgesCleared",i.onGraphEdgesClearedBound),i.graph.on("nodeAttributesUpdated",i.onGraphNodeAttributesUpdatedBound),i.graph.on("edgeAttributesUpdated",i.onGraphEdgeAttributesUpdatedBound),i.graph.on("eachNodeAttributesUpdated",i.onGraphEachNodeAttributesUpdatedBound),i.graph.on("eachEdgeAttributesUpdated",i.onGraphEachEdgeAttributesUpdatedBound),i.createGraph(),i.resetView()})),i}return h(e,t),e.prototype.destroy=function(){this.graph.off("nodeAdded",this.onGraphNodeAddedBound),this.graph.off("edgeAdded",this.onGraphEdgeAddedBound),this.graph.off("nodeDropped",this.onGraphNodeDroppedBound),this.graph.off("edgeDropped",this.onGraphEdgeDroppedBound),this.graph.off("cleared",this.onGraphClearedBound),this.graph.off("edgesCleared",this.onGraphEdgesClearedBound),this.graph.off("nodeAttributesUpdated",this.onGraphNodeAttributesUpdatedBound),this.graph.off("edgeAttributesUpdated",this.onGraphEdgeAttributesUpdatedBound),this.graph.off("eachNodeAttributesUpdated",this.onGraphEachNodeAttributesUpdatedBound),this.graph.off("eachEdgeAttributesUpdated",this.onGraphEachEdgeAttributesUpdatedBound),this.resizeObserver.disconnect(),this.resizeObserver=void 0,this.textureCache.destroy(),this.textureCache=void 0,this.app.destroy(!0,{children:!0,texture:!0,baseTexture:!0}),this.app=void 0},Object.defineProperty(e.prototype,"zoomStep",{get:function(){return Math.min(this.viewport.worldWidth,this.viewport.worldHeight)/10},enumerable:!1,configurable:!0}),e.prototype.zoomIn=function(){this.viewport.zoom(-this.zoomStep,!0)},e.prototype.zoomOut=function(){this.viewport.zoom(this.zoomStep,!0)},e.prototype.resetView=function(){var t=this,e=this.graph.nodes().map((function(e){return t.graph.getNodeAttribute(e,"x")})),i=this.graph.nodes().map((function(e){return t.graph.getNodeAttribute(e,"y")})),s=Math.min.apply(Math,e),o=Math.max.apply(Math,e),r=Math.min.apply(Math,i),h=Math.max.apply(Math,i),a=Math.abs(o-s),p=Math.abs(h-r),l=new n.Point(s+a/2,r+p/2),d=a+200,c=p+200;this.viewport.resize(this.container.clientWidth,this.container.clientHeight,d,c),this.viewport.setZoom(1),this.viewport.center=l,this.viewport.fit(!0)},e.prototype.onGraphNodeAdded=function(t){var e=t.key,i=t.attributes;this.createNode(e,i)},e.prototype.onGraphEdgeAdded=function(t){var e=t.key,i=t.attributes,s=t.source,n=t.target,o=this.graph.getNodeAttributes(s),r=this.graph.getNodeAttributes(n);this.createEdge(e,i,s,n,o,r)},e.prototype.onGraphNodeDropped=function(t){var e=t.key;this.dropNode(e)},e.prototype.onGraphEdgeDropped=function(t){var e=t.key;this.dropEdge(e)},e.prototype.onGraphCleared=function(){Array.from(this.edgeKeyToEdgeObject.keys()).forEach(this.dropEdge.bind(this)),Array.from(this.nodeKeyToNodeObject.keys()).forEach(this.dropNode.bind(this))},e.prototype.onGraphEdgesCleared=function(){Array.from(this.edgeKeyToEdgeObject.keys()).forEach(this.dropEdge.bind(this))},e.prototype.onGraphNodeAttributesUpdated=function(t){var e=t.key;this.updateNodeStyleByKey(e)},e.prototype.onGraphEdgeAttributesUpdated=function(t){var e=t.key;this.updateEdgeStyleByKey(e)},e.prototype.onGraphEachNodeAttributesUpdated=function(){this.graph.forEachNode(this.updateNodeStyle.bind(this))},e.prototype.onGraphEachEdgeAttributesUpdated=function(){this.graph.forEachEdge(this.updateEdgeStyle.bind(this))},e.prototype.hoverNode=function(t){var e=this.nodeKeyToNodeObject.get(t);if(!e.hovered){e.hovered=!0,this.updateNodeStyleByKey(t);var i=this.nodeLayer.getChildIndex(e.nodeGfx);this.nodeLayer.removeChildAt(i),this.nodeLabelLayer.removeChildAt(i),this.frontNodeLayer.removeChildAt(i),this.frontNodeLabelLayer.removeChildAt(i),this.nodeLayer.addChild(e.nodePlaceholderGfx),this.nodeLabelLayer.addChild(e.nodeLabelPlaceholderGfx),this.frontNodeLayer.addChild(e.nodeGfx),this.frontNodeLabelLayer.addChild(e.nodeLabelGfx)}},e.prototype.unhoverNode=function(t){var e=this.nodeKeyToNodeObject.get(t);if(e.hovered){e.hovered=!1,this.updateNodeStyleByKey(t);var i=this.frontNodeLayer.getChildIndex(e.nodeGfx);this.nodeLayer.removeChildAt(i),this.nodeLabelLayer.removeChildAt(i),this.frontNodeLayer.removeChildAt(i),this.frontNodeLabelLayer.removeChildAt(i),this.nodeLayer.addChild(e.nodeGfx),this.nodeLabelLayer.addChild(e.nodeLabelGfx),this.frontNodeLayer.addChild(e.nodePlaceholderGfx),this.frontNodeLabelLayer.addChild(e.nodeLabelPlaceholderGfx)}},e.prototype.hoverEdge=function(t){var e=this.edgeKeyToEdgeObject.get(t);if(!e.hovered){e.hovered=!0,this.updateEdgeStyleByKey(t);var i=this.edgeLayer.getChildIndex(e.edgeGfx);this.edgeLayer.removeChildAt(i),this.frontEdgeLayer.removeChildAt(i),this.edgeLayer.addChild(e.edgePlaceholderGfx),this.frontEdgeLayer.addChild(e.edgeGfx)}},e.prototype.unhoverEdge=function(t){var e=this.edgeKeyToEdgeObject.get(t);if(e.hovered){e.hovered=!1,this.updateEdgeStyleByKey(t);var i=this.frontEdgeLayer.getChildIndex(e.edgeGfx);this.edgeLayer.removeChildAt(i),this.frontEdgeLayer.removeChildAt(i),this.edgeLayer.addChild(e.edgeGfx),this.frontEdgeLayer.addChild(e.edgePlaceholderGfx)}},e.prototype.moveNode=function(t,e){this.graph.setNodeAttribute(t,"x",e.x),this.graph.setNodeAttribute(t,"y",e.y),this.updateNodeStyleByKey(t),this.graph.edges(t).forEach(this.updateEdgeStyleByKey.bind(this))},e.prototype.enableNodeDragging=function(){this.viewport.pause=!0,document.addEventListener("mousemove",this.onDocumentMouseMoveBound)},e.prototype.onDocumentMouseMove=function(t){var e=new n.Point(t.offsetX,t.offsetY),i=this.viewport.toWorld(e);this.mousedownNodeKey&&this.moveNode(this.mousedownNodeKey,i)},e.prototype.onDocumentMouseUp=function(){this.viewport.pause=!1,document.removeEventListener("mousemove",this.onDocumentMouseMoveBound),this.mousedownNodeKey=null,this.mousedownEdgeKey=null},e.prototype.createGraph=function(){this.graph.forEachNode(this.createNode.bind(this)),this.graph.forEachEdge(this.createEdge.bind(this))},e.prototype.createNode=function(t,e){var i=this,s=new Yt;s.on("mousemove",(function(e){i.emit("nodeMousemove",e,t)})),s.on("mouseover",(function(e){i.mousedownNodeKey||i.hoverNode(t),i.emit("nodeMouseover",e,t)})),s.on("mouseout",(function(e){i.mousedownNodeKey||i.unhoverNode(t),i.emit("nodeMouseout",e,t)})),s.on("mousedown",(function(e){i.mousedownNodeKey=t,i.nodeDragging&&i.enableNodeDragging(),document.addEventListener("mouseup",i.onDocumentMouseUpBound,{once:!0}),i.emit("nodeMousedown",e,t)})),s.on("mouseup",(function(e){i.emit("nodeMouseup",e,t),i.mousedownNodeKey===t&&i.emit("nodeClick",e,t)})),this.nodeLayer.addChild(s.nodeGfx),this.nodeLabelLayer.addChild(s.nodeLabelGfx),this.frontNodeLayer.addChild(s.nodePlaceholderGfx),this.frontNodeLabelLayer.addChild(s.nodeLabelPlaceholderGfx),this.nodeKeyToNodeObject.set(t,s),this.updateNodeStyle(t,e)},e.prototype.createEdge=function(t,e,i,s,n,o){var r=this,h=new Ut;h.on("mousemove",(function(e){r.emit("edgeMousemove",e,t)})),h.on("mouseover",(function(e){r.hoverEdge(t),r.emit("edgeMouseover",e,t)})),h.on("mouseout",(function(e){r.unhoverEdge(t),r.emit("edgeMouseout",e,t)})),h.on("mousedown",(function(e){r.mousedownEdgeKey=t,r.emit("edgeMousedown",e,t)})),h.on("mouseup",(function(e){r.emit("edgeMouseup",e,t),r.mousedownEdgeKey===t&&r.emit("edgeClick",e,t)})),this.edgeLayer.addChild(h.edgeGfx),this.frontEdgeLayer.addChild(h.edgePlaceholderGfx),this.edgeKeyToEdgeObject.set(t,h),this.updateEdgeStyle(t,e,i,s,n,o)},e.prototype.dropNode=function(t){var e=this.nodeKeyToNodeObject.get(t);this.nodeLayer.removeChild(e.nodeGfx),this.nodeLabelLayer.removeChild(e.nodeLabelGfx),this.frontNodeLayer.removeChild(e.nodePlaceholderGfx),this.frontNodeLabelLayer.removeChild(e.nodeLabelPlaceholderGfx),this.nodeKeyToNodeObject.delete(t)},e.prototype.dropEdge=function(t){var e=this.edgeKeyToEdgeObject.get(t);this.edgeLayer.removeChild(e.edgeGfx),this.frontEdgeLayer.removeChild(e.edgePlaceholderGfx),this.edgeKeyToEdgeObject.delete(t)},e.prototype.updateNodeStyleByKey=function(t){var e=this.graph.getNodeAttributes(t);this.updateNodeStyle(t,e)},e.prototype.updateNodeStyle=function(t,e){var i=this.nodeKeyToNodeObject.get(t),s={x:e.x,y:e.y};i.updatePosition(s);var n=St([Kt.node,this.style.node,i.hovered?this.hoverStyle.node:void 0],e);i.updateStyle(n,this.textureCache)},e.prototype.updateEdgeStyleByKey=function(t){var e=this.graph.getEdgeAttributes(t),i=this.graph.source(t),s=this.graph.target(t),n=this.graph.getNodeAttributes(i),o=this.graph.getNodeAttributes(s);this.updateEdgeStyle(t,e,i,s,n,o)},e.prototype.updateEdgeStyle=function(t,e,i,s,n,o){var r=this.edgeKeyToEdgeObject.get(t),h={x:n.x,y:n.y},a={x:o.x,y:o.y};r.updatePosition(h,a);var p=St([Kt.edge,this.style.edge,r.hovered?this.hoverStyle.edge:void 0],e);r.updateStyle(p,this.textureCache)},e.prototype.updateGraphVisibility=function(){var t=this,e=new tt;e.addAll(this.viewport.children.map((function(t){return t.children})).flat()),e.cull(this.app.renderer.screen);var i=this.viewport.scale.x,s=[.1,.2,.4,1/0].findIndex((function(t){return i<=t}));this.graph.forEachNode((function(e){t.nodeKeyToNodeObject.get(e).updateVisibility(s)})),this.graph.forEachEdge((function(e){t.edgeKeyToEdgeObject.get(e).updateVisibility(s)}))},e}(vt.TypedEmitter);t.PixiGraph=Ft,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=pixi-graph.umd.min.js.map
